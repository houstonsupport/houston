/* houston, built Tue Jul 14 2015 22:17:52 */

this.JST=this.JST||{},this.JST.accountview=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="box-app-fixed">\n	<div class="box-app-fixed-inner">\n		<div class="box-app-top">\n			<h2>Manage Your Account</h2>\n		</div>\n	</div>\n</div>\n<div class="box-app" style="'+this.escapeExpression((e=null!=(e=b.fullHeightPage||(null!=a?a.fullHeightPage:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"fullHeightPage",hash:{},data:d}):e))+'">\n</div>'},useData:!0}),this.JST.analyticsview=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="box-app-fixed">\n	<div class="box-app-fixed-inner">\n		<div class="box-app-top">\n			<h2>System Analytics</h2>\n		</div>\n	</div>\n</div>\n<div class="box-app" style="'+this.escapeExpression((e=null!=(e=b.fullHeightPage||(null!=a?a.fullHeightPage:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"fullHeightPage",hash:{},data:d}):e))+'">\n</div>'},useData:!0}),this.JST.clientsview=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'<div id="company-stream">\n	<div id="modal-form" class="active">\n		<div class="modal-window-inner">\n            <div class="modal-outer">\n				<div class="modal-wrap">\n					<div class="box">\n						<form>\n							<h3>Text</h3>\n							<h4>Text</h4>\n							<div class="modal-buttons">\n								<input id="modal-form-input" type="text" />\n								<div class="validated-marker">\n			                        <div class="vrf-cir">\n			                            <i class="icon-cancel"></i>\n			                        </div>\n			                    </div>\n								<button class="confirm" type="button">OK</button>\n								<div class="beige or">or</div>\n								<button class="btn-can" type="button">Cancel</button>\n							</div>\n						</form>\n					</div>\n				</div>\n			</div>\n        </div>\n	</div>\n	<ul id="clients-stream">\n	</ul>\n</div>'},useData:!0}),this.JST.clientview=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return'<div class="company-info">\n	<h3>'+g(f(null!=(e=null!=a?a.attributes:a)?e.name:e,a))+'</h3>\n	<a class="edit-client" data-form="3" data-model="'+g(f(null!=(e=null!=a?a.attributes:a)?e.id:e,a))+'">Rename</a>\n	<a class="delete-client">Delete</a>\n	<a class="new-client-user" data-form="2" data-model="'+g(f(null!=(e=null!=a?a.attributes:a)?e.id:e,a))+'">New User</a>\n</div>\n<div class="client-stream">\n	<ul class="client-user-stream">\n	</ul>\n</div>'},useData:!0}),this.JST.fileuploadview=Handlebars.template({1:function(a,b,c,d){var e,f,g=this.lambda,h=this.escapeExpression;return'		<li class="file">\n			<div class="file-text '+h(g(null!=(e=null!=a?a.attributes:a)?e.status:e,a))+'">\n				<img class="svg-loader" src="/application/assets/img/oval.svg" width="52" alt="Loading">\n  				<div class="file-icon">\n  					<span>\n'+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.attributes:a)?e.type:e,{name:"if",hash:{},fn:this.program(2,d,0),inverse:this.program(4,d,0),data:d}))?e:"")+'  					</span>\n  				</div>\n  				<div class="file-info">\n					<div class="filename">'+h(g(null!=(e=null!=a?a.attributes:a)?e.name:e,a))+'</div>\n					<a data-cid="'+h((f=null!=(f=b.cid||(null!=a?a.cid:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"cid",hash:{},data:d}):f))+'" class="file-del">Delete</a>\n'+(null!=(e=b.unless.call(a,null!=(e=null!=a?a.attributes:a)?e.status:e,{name:"unless",hash:{},fn:this.program(6,d,0),inverse:this.noop,data:d}))?e:"")+"				</div>\n			</div>			\n		</li>\n"},2:function(a,b,c,d){var e;return"  					"+this.escapeExpression((b.formatFileType||a&&a.formatFileType||b.helperMissing).call(a,null!=(e=null!=a?a.attributes:a)?e.type:e,{name:"formatFileType",hash:{},data:d}))+"\n"},4:function(a,b,c,d){return"  					FILE\n"},6:function(a,b,c,d){var e;return"						"+this.escapeExpression((b.showFileUploadPreviewLink||a&&a.showFileUploadPreviewLink||b.helperMissing).call(a,null!=(e=null!=a?a.attributes:a)?e.type:e,null!=(e=null!=a?a.attributes:a)?e.target:e,null!=a?a.cid:a,{name:"showFileUploadPreviewLink",hash:{},data:d}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="attach-files">\n	<a class="attach-link">Attach files to this ticket</a>\n	<div class="supported">Supported -</div>\n	<ul class="filetypes">\n		<li>Jpg</li>\n		<li>Png</li>\n		<li>Gif</li>\n		<li>Pdf</li>\n	</ul>\n	<div class="file-input-wrapper">\n		<div id="drop_zone">Drop files here</div>\n		<input type="file" id="filesInput" name="files[]" multiple />\n	</div>\n	<ul id="files" class="files">\n'+(null!=(e=b.each.call(a,null!=a?a.models:a,{name:"each",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+"	</ul>\n</div>"},useData:!0}),this.JST.formview=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="box-app-fixed">\n	<div class="box-app-fixed-inner">\n		<div class="box-app-top">\n			<h2>Create Ticket</h2>\n		</div>\n	</div>\n</div>\n<div class="box-app" style="'+this.escapeExpression((e=null!=(e=b.fullHeightPage||(null!=a?a.fullHeightPage:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"fullHeightPage",hash:{},data:d}):e))+'">\n	<form id="form-new">\n		<input type="text" class="required new-sub" name="new-sub" placeholder="The problem in one sentence" />\n		<div class="char-count"><span>75</span> Characters Remaining</div>\n		<textarea class="required" name="new-textarea" placeholder="Please provide the specifics of your problem here"></textarea>\n		<div id="file-upload-view-wrap">\n		</div>\n		<button class="save" type="button">Create Ticket</button>\n		<div class="beige or">or</div>\n		<a class="cancel-btn ib">Cancel</a>\n	</form>\n</div>'},useData:!0}),this.JST.messagesview=Handlebars.template({1:function(a,b,c,d){var e,f,g=b.helperMissing,h=this.escapeExpression;return'	<li class="msg from-'+h((b.getUserRoleAsClass||a&&a.getUserRoleAsClass||g).call(a,null!=(e=null!=a?a.attributes:a)?e.authorID:e,{name:"getUserRoleAsClass",hash:{},data:d}))+'">\n		<div class="msg-dtl">\n			<img class="avatar" src="'+h((b.getUserAvatar||a&&a.getUserAvatar||g).call(a,null!=(e=null!=a?a.attributes:a)?e.authorID:e,{name:"getUserAvatar",hash:{},data:d}))+'" alt="'+h((b.getUserName||a&&a.getUserName||g).call(a,null!=(e=null!=a?a.attributes:a)?e.authorID:e,{name:"getUserName",hash:{},data:d}))+'" />\n			<div class="msg-dtl-inr">\n				<h3 class="msg-agent">'+h((b.getUserName||a&&a.getUserName||g).call(a,null!=(e=null!=a?a.attributes:a)?e.authorID:e,{name:"getUserName",hash:{},data:d}))+'</h3>\n				<h4 class="msg-company">'+h((b.getCompanyName||a&&a.getCompanyName||g).call(a,null!=(e=null!=a?a.attributes:a)?e.authorID:e,{name:"getCompanyName",hash:{},data:d}))+'</h4>\n				<div class="msg-date">'+h((b.convertToDateTime||a&&a.convertToDateTime||g).call(a,null!=(e=null!=a?a.attributes:a)?e.date:e,{name:"convertToDateTime",hash:{},data:d}))+'</div>\n			</div>\n			<div class="msg-tri"></div>\n		</div>\n		<div class="msg-body">\n			<div>\n				'+h(this.lambda(null!=(e=null!=a?a.attributes:a)?e.message:e,a))+'\n			</div>\n			<ul class="files" data-reply="'+h((f=null!=(f=b.id||(null!=a?a.id:a))?f:g,"function"==typeof f?f.call(a,{name:"id",hash:{},data:d}):f))+'">\n'+(null!=(e=b.each.call(a,null!=(e=null!=a?a.attributes:a)?e.files:e,{name:"each",hash:{},fn:this.program(2,d,0),inverse:this.noop,data:d}))?e:"")+"			</ul>\n			"+h((b.downloadTicketAttachments||a&&a.downloadTicketAttachments||g).call(a,null!=(e=null!=a?a.attributes:a)?e.files:e,{name:"downloadTicketAttachments",hash:{},data:d}))+"\n"+(null!=(e=b["if"].call(a,null!=a?a.$last:a,{name:"if",hash:{},fn:this.program(7,d,0),inverse:this.program(9,d,0),data:d}))?e:"")+"	</li>\n"},2:function(a,b,c,d){var e,f,g=b.helperMissing,h="function",i=this.escapeExpression;return'				<li class="file">\n					<div class="file-text">\n		  				<div class="file-icon">\n		  					<span>\n'+(null!=(e=b["if"].call(a,null!=a?a.type:a,{name:"if",hash:{},fn:this.program(3,d,0),inverse:this.program(5,d,0),data:d}))?e:"")+'		  					</span>\n		  				</div>\n		  				<div class="file-info">\n							<div class="filename">'+i((f=null!=(f=b.name||(null!=a?a.name:a))?f:g,typeof f===h?f.call(a,{name:"name",hash:{},data:d}):f))+"</div>\n							"+i((b.showFilePreviewLink||a&&a.showFilePreviewLink||g).call(a,null!=a?a.type:a,d&&d.index,{name:"showFilePreviewLink",hash:{},data:d}))+'\n							<a data-bypass="true" href="/api/tickets/file/'+i((f=null!=(f=b.ref||(null!=a?a.ref:a))?f:g,typeof f===h?f.call(a,{name:"ref",hash:{},data:d}):f))+'">Download</a>\n						</div>\n					</div>\n				</li>\n'},3:function(a,b,c,d){return"		  					"+this.escapeExpression((b.formatFileType||a&&a.formatFileType||b.helperMissing).call(a,null!=a?a.type:a,{name:"formatFileType",hash:{},data:d}))+"\n"},5:function(a,b,c,d){return"		  					FILE\n"},7:function(a,b,c,d){var e;return'			<a class="btn reply-btn">Reply</a>\n		</div>\n		<div class="reply">\n			<form id="form-reply">\n				<textarea class="required" name="new-textarea" placeholder="Please add your comments here..."></textarea>\n				<div id="file-upload-view-wrap">\n				</div>\n				'+this.escapeExpression((e=null!=(e=b.outputMarkAsCompleted||(null!=a?a.outputMarkAsCompleted:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"outputMarkAsCompleted",hash:{},data:d}):e))+'\n				<div class="reply-submit-buttons">\n					<button class="add-message" type="button">Submit</button>\n					<div class="beige or">or</div>\n					<a class="cancel-btn ib">Cancel</a>\n				</div>\n			</form>\n		</div>\n'},9:function(a,b,c,d){return"		</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return null!=(e=(b.forEach||a&&a.forEach||b.helperMissing).call(a,null!=a?a.models:a,{name:"forEach",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:""},useData:!0}),this.JST.modalview=Handlebars.template({1:function(a,b,c,d){return'			<div class="beige or">or</div>\n			<button class="btn-can" type="button">Cancel</button>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f,g=b.helperMissing,h="function",i=this.escapeExpression;return'<div class="modal-outer">\n	<div class="modal-wrap">\n		<div class="box">\n		<h3>'+i((f=null!=(f=b.type||(null!=a?a.type:a))?f:g,typeof f===h?f.call(a,{name:"type",hash:{},data:d}):f))+"</h3>\n		<h4>"+i((f=null!=(f=b.message||(null!=a?a.message:a))?f:g,typeof f===h?f.call(a,{name:"message",hash:{},data:d}):f))+'</h4>\n		<div class="modal-buttons">\n			<button class="confirm" type="button">OK</button>\n'+(null!=(e=b["if"].call(a,null!=a?a.cancel:a,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+"		</div>\n		</div>\n	</div>\n</div>"},useData:!0}),this.JST.peopleview=Handlebars.template({1:function(a,b,c,d){var e,f=b.helperMissing;return'			<li class="person">\n'+(null!=(e=(b.ifCond||a&&a.ifCond||f).call(a,null!=(e=null!=a?a.attributes:a)?e.verify:e,!0,{name:"ifCond",hash:{},fn:this.program(2,d,0),inverse:this.program(11,d,0),data:d}))?e:"")+"				"+this.escapeExpression((b.displayAgentDelete||a&&a.displayAgentDelete||f).call(a,null!=a?a.id:a,{name:"displayAgentDelete",hash:{},data:d}))+"\n			</li>\n"},2:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return'					<img class="avatar" src="'+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.attributes:a)?e.avatar:e,{name:"if",hash:{},fn:this.program(3,d,0),inverse:this.program(5,d,0),data:d}))?e:"")+'" alt="'+g(f(null!=(e=null!=a?a.attributes:a)?e.firstName:e,a))+" "+g(f(null!=(e=null!=a?a.attributes:a)?e.lastName:e,a))+'" />\n					<h3>'+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.attributes:a)?e.firstName:e,{name:"if",hash:{},fn:this.program(7,d,0),inverse:this.program(9,d,0),data:d}))?e:"")+"</h3>\n					<h4>"+g((b.convertUserRole||a&&a.convertUserRole||b.helperMissing).call(a,null!=(e=null!=a?a.attributes:a)?e.role:e,{name:"convertUserRole",hash:{},data:d}))+"</h4>\n"},3:function(a,b,c,d){var e;return this.escapeExpression(this.lambda(null!=(e=null!=a?a.attributes:a)?e.avatar:e,a))},5:function(a,b,c,d){return"application/assets/img/avatar.png"},7:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return g(f(null!=(e=null!=a?a.attributes:a)?e.firstName:e,a))+" "+g(f(null!=(e=null!=a?a.attributes:a)?e.lastName:e,a))},9:function(a,b,c,d){var e;return this.escapeExpression(this.lambda(null!=(e=null!=a?a.attributes:a)?e.emailAddress:e,a))},11:function(a,b,c,d){var e;return'					<img class="avatar" src="application/assets/img/avatar.png" />\n					<h3>'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.attributes:a)?e.emailAddress:e,a))+'</h3>\n					<h4>Awaiting Verification</h4>\n					<a class="resend-verification">Resend</a> \n'},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f;return'<div class="box-app-fixed">\n	<div class="box-app-fixed-inner">\n		<div class="box-app-top">\n			<h2>People</h2>\n			<a class="btn new-client" data-form="1">New Client</a>\n			<a class="btn" data-form="0">New Agent</a>\n		</div>\n	</div>\n</div>\n<div class="box-app box-people" style="'+this.escapeExpression((f=null!=(f=b.fullHeightPage||(null!=a?a.fullHeightPage:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"fullHeightPage",hash:{},data:d}):f))+'">\n	<div id="agent-stream">\n	<h2>Support Agents</h2>\n		<ul>\n'+(null!=(e=b.each.call(a,null!=a?a.models:a,{name:"each",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+'		</ul>\n	</div>\n	<h2 class="people-clients-header">Clients</h2>\n	<div id="clients-wrap">\n	</div>\n</div>'},useData:!0}),this.JST.previewwindow=Handlebars.template({1:function(a,b,c,d){var e;return null!=(e=b["if"].call(a,null!=(e=null!=a?a.attributes:a)?e.preview:e,{name:"if",hash:{},fn:this.program(2,d,0),inverse:this.noop,data:d}))?e:""},2:function(a,b,c,d){var e,f=b.helperMissing,g=this.escapeExpression;return'		<div class="preview-wrap">\n			<div class="preview-img-wrap">\n				<i class="preview-close icon-cancel-circled"></i>\n				<div class="preview-img-box">\n					<div class="preview-img-info">\n						<div class="preview-prev">\n							'+g((b.generateFilePreviousLink||a&&a.generateFilePreviousLink||f).call(a,d&&d.index,{name:"generateFilePreviousLink",hash:{},data:d}))+'				\n						</div>\n						<h3 class="preview-filename">'+g(this.lambda(null!=(e=null!=a?a.attributes:a)?e.name:e,a))+'</h3>\n						<div class="preview-next">	\n							'+g((b.generateFileNextLink||a&&a.generateFileNextLink||f).call(a,d&&d.index,null!=(e=null!=a?a.collection:a)?e.length:e,{name:"generateFileNextLink",hash:{},data:d}))+'\n						</div>\n					</div>\n					<div class="img-wrap">					\n'+(null!=(e=(b.ifCond||a&&a.ifCond||f).call(a,null!=(e=null!=a?a.attributes:a)?e.type:e,"application/pdf",{name:"ifCond",hash:{},fn:this.program(3,d,0),inverse:this.program(5,d,0),data:d}))?e:"")+'					</div>\n					<div class="preview-img-bottom">\n						<div class="preview-type">\n							'+g((b.formatFileType||a&&a.formatFileType||f).call(a,null!=(e=null!=a?a.attributes:a)?e.type:e,{name:"formatFileType",hash:{},data:d}))+'\n						</div>\n						<div class="preview-download">\n							<a data-bypass="true" href="'+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.attributes:a)?e.ref:e,{name:"if",hash:{},fn:this.program(6,d,0),inverse:this.program(8,d,0),data:d}))?e:"")+'"><i class="icon-down-circled2"></i></a>\n						</div>\n					</div>\n				</div>\n			</div>\n		</div>\n'},3:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return'						    <object data="/api/tickets/file/inline/'+g(f(null!=(e=null!=a?a.attributes:a)?e.ref:e,a))+'" type="application/pdf" width="100%" height="100%" frameborder="0"> alt : <a href="/api/tickets/file/'+g(f(null!=(e=null!=a?a.attributes:a)?e.ref:e,a))+'">test.pdf</a> </object>\n'},5:function(a,b,c,d){var e,f;return'						    <img class="preview-img" style="max-height:'+this.escapeExpression((f=null!=(f=b.maxHeightImg||(null!=a?a.maxHeightImg:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"maxHeightImg",hash:{},data:d}):f))+'px;" src="'+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.attributes:a)?e.ref:e,{name:"if",hash:{},fn:this.program(6,d,0),inverse:this.program(8,d,0),data:d}))?e:"")+'" />	\n'},6:function(a,b,c,d){var e;return"/api/tickets/file/"+this.escapeExpression(this.lambda(null!=(e=null!=a?a.attributes:a)?e.ref:e,a))},8:function(a,b,c,d){var e;return this.escapeExpression(this.lambda(null!=(e=null!=a?a.attributes:a)?e.target:e,a))},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return null!=(e=b.each.call(a,null!=a?a.models:a,{name:"each",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:""},useData:!0}),this.JST.profileview=Handlebars.template({1:function(a,b,c,d){var e;return this.escapeExpression(this.lambda(null!=(e=null!=a?a.attributes:a)?e.avatar:e,a))},3:function(a,b,c,d){return"application/assets/img/avatar.png"},5:function(a,b,c,d){var e;return this.escapeExpression(this.lambda(null!=(e=null!=a?a.attributes:a)?e.emailNotifications:e,a))},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f,g=this.escapeExpression,h=this.lambda;return'<div class="box-app-fixed">\n	<div class="box-app-fixed-inner">\n		<div class="box-app-top">\n			<h2>Manage Your Profile</h2>\n		</div>\n	</div>\n</div>\n<div class="box-app profile" style="'+g((f=null!=(f=b.fullHeightPage||(null!=a?a.fullHeightPage:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"fullHeightPage",hash:{},data:d}):f))+'">\n	<form id="form-profile-details">	\n        <h3>Your Details</h3>			\n		<div class="profile-input-wrap">\n			<label for="first-name">First Name</label>\n			<input id="first-name" name="firstName" type="text" placeholder="'+g(h(null!=(e=null!=a?a.attributes:a)?e.firstName:e,a))+'" />\n		</div>\n		<div class="profile-input-wrap">\n			<label for="last-name">Last Name</label>\n			<input id="last-name" name="lastName" type="text" placeholder="'+g(h(null!=(e=null!=a?a.attributes:a)?e.lastName:e,a))+'" />\n		</div>\n		<div class="profile-input-wrap">\n			<label for="email-address">Email Address</label>\n			<input id="email-address" name="emailAddress" type="email" placeholder="'+g(h(null!=(e=null!=a?a.attributes:a)?e.emailAddress:e,a))+'" />\n			<h4 class="profile-tooltip">A validation link will be sent to your email address for verification.</h4>\n            <div class="in-use-marker">\n                <div class="vrf-cir">\n                    <i class="icon-cancel"></i>\n                </div>\n            </div>\n		</div>\n		<button type="button">Update</button>\n		<div class="beige or">or</div>\n		<a class="cancel-btn">Cancel</a>\n		<div class="response">\n			<h3>Your profile was succesfully updated</h3>\n		</div>\n	</form>\n	<h3>Update Password</h3>\n	<form id="form-profile-password">\n        <div class="profile-input-wrap">\n			<input class="current-password" type="password" placeholder="Current Password" />\n            <div class="validated-marker">\n                <div class="vrf-cir ok">\n                    <i class="icon-ok-1"></i>\n                </div>\n            </div>\n        </div>    \n        <div class="profile-input-wrap">\n		    <input class="new-password" type="password" placeholder="New Password" disabled />\n            <div class="validated-marker">\n                <div class="vrf-cir vrf-count">8</div>\n            </div>\n        </div>\n        <div class="profile-input-wrap">\n		    <input class="repeat-password" type="password" placeholder="Repeat Password" disabled />\n            <div class="validated-marker">\n                <div class="vrf-cir ok">\n                    <i class="icon-ok-1"></i>\n                </div>\n            </div>\n        </div>\n		<button type="button">Update</button>\n		<div class="beige or">or</div>\n		<a class="cancel-btn">Cancel</a>\n		<div class="response">\n			<h3>Your password has been updated</h3>\n		</div>\n	</form>\n    <div class="profile-avatar">\n        <h3>Avatar</h3>                    \n        <div id="avatar-drop">\n            <img class="avatar" src="'+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.attributes:a)?e.avatar:e,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.program(3,d,0),data:d}))?e:"")+'" />\n        </div>\n        <h4 class="profile-avatar-prompt">Drag and drop image onto area above to update.</h4> \n        <a class="update-avatar-link">Add image from file</a>\n        <input type="file" id="filesInput" name="files" />\n        <div id="canvas-wrap"></div>\n    </div>\n    <div class="email-notifications">\n        <h3>Email Notifications</h3>\n        <div class="toggle-button-wrap">\n            <div class="toggle-button-outer '+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.attributes:a)?e.emailNotifications:e,{name:"if",hash:{},fn:this.program(5,d,0),inverse:this.noop,data:d}))?e:"")+'">\n                <div class="on">on</div>\n                <div class="off">off</div>\n                <div class="toggle-button"></div>\n            </div>\n            <label>Ticket Emails</label>\n        </div>\n        <div class="toggle-button-wrap">\n            <div class="toggle-button-outer '+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.attributes:a)?e.emailNotifications:e,{name:"if",hash:{},fn:this.program(5,d,0),inverse:this.noop,data:d}))?e:"")+'">\n                <div class="on">on</div>\n                <div class="off">off</div>\n                <div class="toggle-button"></div>\n            </div>\n            <label>System Emails</label>\n        </div>\n        <div class="toggle-button-wrap">\n            <div class="toggle-button-outer '+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.attributes:a)?e.emailNotifications:e,{name:"if",hash:{},fn:this.program(5,d,0),inverse:this.noop,data:d}))?e:"")+'">\n                <div class="on">on</div>\n                <div class="off">off</div>\n                <div class="toggle-button"></div>\n            </div>\n            <label>Houston Newsletter</label>\n        </div>\n    </div>\n</div>'},useData:!0}),this.JST.ticketheaderview=Handlebars.template({1:function(a,b,c,d){var e,f,g=b.helperMissing,h=this.escapeExpression;return"	"+h((b.generateDropSwitch||a&&a.generateDropSwitch||g).call(a,null!=(e=null!=a?a.attributes:a)?e.status:e,{name:"generateDropSwitch",hash:{},data:d}))+'					\n	<div class="dropdown droplist">\n		<div class="drop-top rounded">\n			<div class="btn in-progress drop-slct"><span>'+h((b.getUserName||a&&a.getUserName||g).call(a,null!=(e=null!=a?a.attributes:a)?e.agent:e,{name:"getUserName",hash:{},data:d}))+'</span><i class="icon-down-dir-1"></i></div>\n		</div>						\n		<ul class="drop">\n			'+h((f=null!=(f=b.populateAgentDropdown||(null!=a?a.populateAgentDropdown:a))?f:g,"function"==typeof f?f.call(a,{name:"populateAgentDropdown",hash:{},data:d}):f))+"\n		</ul>\n	</div>\n"},3:function(a,b,c,d){var e;return'	<div class="btn new">New</div>\n	<div class="dropdown droplist">\n		<div class="drop-top rounded">\n			<div class="btn in-progress drop-slct">Awaiting Agent<i class="icon-down-dir-1"></i></div>\n		</div>						\n		<ul class="drop">\n			'+this.escapeExpression((e=null!=(e=b.populateAgentDropdown||(null!=a?a.populateAgentDropdown:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"populateAgentDropdown",hash:{},data:d}):e))+"\n		</ul>\n	</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return"<h2>Ticket #"+this.escapeExpression(this.lambda(null!=(e=null!=a?a.attributes:a)?e.reference:e,a))+"</h2>\n"+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.attributes:a)?e.agent:e,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.program(3,d,0),data:d}))?e:"")},useData:!0}),this.JST.ticketheaderviewuser=Handlebars.template({1:function(a,b,c,d){var e,f=b.helperMissing,g=this.escapeExpression;return'	<div class="btn '+g((b.convertToClass||a&&a.convertToClass||f).call(a,null!=(e=null!=a?a.attributes:a)?e.status:e,{name:"convertToClass",hash:{},data:d}))+'">'+g(this.lambda(null!=(e=null!=a?a.attributes:a)?e.status:e,a))+'</div>\n	<div class="btn ticketheader-agent">'+g((b.getUserName||a&&a.getUserName||f).call(a,null!=(e=null!=a?a.attributes:a)?e.agent:e,{name:"getUserName",hash:{},data:d}))+"</div>\n"},3:function(a,b,c,d){return'	<div class="btn new">New</div>\n	<div class="btn on-hold">Awaiting Agent</div>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return"<h2>Ticket #"+this.escapeExpression(this.lambda(null!=(e=null!=a?a.attributes:a)?e.reference:e,a))+"</h2>\n"+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.attributes:a)?e.agent:e,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.program(3,d,0),data:d}))?e:"")},useData:!0}),this.JST.ticketsview=Handlebars.template({1:function(a,b,c,d){var e;return null!=(e=b.each.call(a,null!=a?a.models:a,{name:"each",hash:{},fn:this.program(2,d,0),inverse:this.noop,data:d}))?e:""},2:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression,h=b.helperMissing;return'		<li class="ticket">\n			<a href="/tickets/'+g(f(null!=(e=null!=a?a.attributes:a)?e.id:e,a))+'">\n				<div class="update-alert '+g((b.updateCheck||a&&a.updateCheck||h).call(a,null!=(e=null!=a?a.attributes:a)?e.updated:e,{name:"updateCheck",hash:{},data:d}))+'"></div>\n				<div class="ticket-info">					\n					<div class="date">'+g((b.convertToDate||a&&a.convertToDate||h).call(a,null!=(e=null!=a?a.attributes:a)?e.date:e,{name:"convertToDate",hash:{},data:d}))+'</div>\n					<div class="ticket-info-inner">\n						<div class="name">'+g((b.getUserName||a&&a.getUserName||h).call(a,null!=(e=null!=a?a.attributes:a)?e.authorID:e,{name:"getUserName",hash:{},data:d}))+'</div>\n						<div class="company-name">'+g((b.getCompanyName||a&&a.getCompanyName||h).call(a,null!=(e=null!=a?a.attributes:a)?e.authorID:e,{name:"getCompanyName",hash:{},data:d}))+'</div>\n						<div class="summary"><span>#'+g(f(null!=(e=null!=a?a.attributes:a)?e.reference:e,a))+"</span> "+g(f(null!=(e=null!=a?a.attributes:a)?e.subject:e,a))+'</div>\n					</div>\n				</div>\n				<div class="ticket-status">\n					<div class="btn '+g((b.convertToClass||a&&a.convertToClass||h).call(a,null!=(e=null!=a?a.attributes:a)?e.status:e,{name:"convertToClass",hash:{},data:d}))+'">'+g(f(null!=(e=null!=a?a.attributes:a)?e.status:e,a))+"</div>\n"+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.attributes:a)?e.agent:e,{name:"if",hash:{},fn:this.program(3,d,0),inverse:this.program(5,d,0),data:d}))?e:"")+"				</div>\n			</a>\n		</li>\n"},3:function(a,b,c,d){var e;return'						<div class="ticket-agent">'+this.escapeExpression((b.getUserName||a&&a.getUserName||b.helperMissing).call(a,null!=(e=null!=a?a.attributes:a)?e.agent:e,{name:"getUserName",hash:{},data:d}))+"</div>\n"},5:function(a,b,c,d){return'						<div class="ticket-agent">Awaiting Agent</div>\n'},7:function(a,b,c,d){return'	<h4 class="no-tickets">No tickets to display</h4>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f,g=b.helperMissing,h="function",i=this.escapeExpression;return'<div class="box-app-fixed">\n	<div class="box-app-fixed-inner">\n		<div class="box-app-top">\n			<h2>Open Tickets</h2>\n			<a href="/tickets/new" class="btn">New Ticket</a>\n		</div>	\n		<div class="box-app-nav">\n			<div class="helper">\n				<div class="box-app-nav-inner">\n					<div class="sort">\n						<a class="sortByDate">Sort By Date '+i((f=null!=(f=b.dateArrow||(null!=a?a.dateArrow:a))?f:g,typeof f===h?f.call(a,{name:"dateArrow",hash:{},data:d}):f))+'</a>\n						<a class="sortByCompany mid-link">Sort By Company '+i((f=null!=(f=b.companyArrow||(null!=a?a.companyArrow:a))?f:g,typeof f===h?f.call(a,{name:"companyArrow",hash:{},data:d}):f))+'</a>\n					</div>\n					<div class="filter">\n						\n						<a class="allTickets">All<span> Tickets</span></a>\n						<a class="updatedTickets">Updated<span> Tickets</span></a>\n						<a class="myTickets"><span class="mine">Mine</span><span>My Tickets</span></a>\n						<a class="completedTickets">Completed<span> Tickets</span></a>\n					</div>\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n<div class="box-app tickets-box-app" style="'+i((f=null!=(f=b.fullHeightPage||(null!=a?a.fullHeightPage:a))?f:g,typeof f===h?f.call(a,{name:"fullHeightPage",hash:{},data:d}):f))+'">\n	<ul id="ticket-stream">\n'+(null!=(e=b["if"].call(a,null!=a?a.models:a,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.program(7,d,0),data:d}))?e:"")+'	</ul>\n	<div class="loader">\n	<div class="otloader"></div>\n	</div>\n</div>'},useData:!0}),this.JST.ticketview=Handlebars.template({1:function(a,b,c,d){var e,f,g=b.helperMissing,h="function",i=this.escapeExpression;return'				<li class="file">\n					<div class="file-text">\n		  				<div class="file-icon">\n		  					<span>\n'+(null!=(e=b["if"].call(a,null!=a?a.type:a,{name:"if",hash:{},fn:this.program(2,d,0),inverse:this.program(4,d,0),data:d}))?e:"")+'		  					</span>\n		  				</div>\n		  				<div class="file-info">\n							<div class="filename">'+i((f=null!=(f=b.name||(null!=a?a.name:a))?f:g,typeof f===h?f.call(a,{name:"name",hash:{},data:d}):f))+"</div>\n							"+i((b.showFilePreviewLink||a&&a.showFilePreviewLink||g).call(a,null!=a?a.type:a,d&&d.index,{name:"showFilePreviewLink",hash:{},data:d}))+'\n							<a data-bypass="true" href="/api/tickets/file/'+i((f=null!=(f=b.ref||(null!=a?a.ref:a))?f:g,typeof f===h?f.call(a,{name:"ref",hash:{},data:d}):f))+'">Download</a>\n						</div>\n					</div>\n				</li>	\n'},2:function(a,b,c,d){return"		  					"+this.escapeExpression((b.formatFileType||a&&a.formatFileType||b.helperMissing).call(a,null!=a?a.type:a,{name:"formatFileType",hash:{},data:d}))+"\n"},4:function(a,b,c,d){return"		  					FILE\n"},6:function(a,b,c,d){return"			</div>											\n"},8:function(a,b,c,d){var e;return'		<a class="btn reply-btn">Reply</a>\n		</div>\n		<div class="reply">\n			<form id="form-reply">\n				<textarea class="required" name="new-textarea" placeholder="Please add your comments here..."></textarea>	\n				<div id="file-upload-view-wrap">	\n				</div>\n				'+this.escapeExpression((e=null!=(e=b.outputMarkAsCompleted||(null!=a?a.outputMarkAsCompleted:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"outputMarkAsCompleted",hash:{},data:d}):e))+'\n				<div class="reply-submit-buttons">\n					<button class="add-message" type="button">Submit</button>\n					<div class="beige or">or</div>\n					<a class="cancel-btn ib">Cancel</a>\n				</div>\n			</form>\n		</div>					\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f,g=b.helperMissing,h=this.escapeExpression,i=this.lambda;return'<div class="box-app-fixed">\n	<div class="box-app-fixed-inner">\n	</div>\n</div>			\n<ul id="msg-stream" class="box-app" style="'+h((f=null!=(f=b.fullHeightPage||(null!=a?a.fullHeightPage:a))?f:g,"function"==typeof f?f.call(a,{name:"fullHeightPage",hash:{},data:d}):f))+'">		\n	<li class="msg from-'+h((b.getUserRoleAsClass||a&&a.getUserRoleAsClass||g).call(a,null!=(e=null!=a?a.attributes:a)?e.authorID:e,{name:"getUserRoleAsClass",hash:{},data:d}))+'">\n		<div class="msg-dtl">\n			<img class="avatar" src="'+h((b.getUserAvatar||a&&a.getUserAvatar||g).call(a,null!=(e=null!=a?a.attributes:a)?e.authorID:e,{name:"getUserAvatar",hash:{},data:d}))+'" alt="'+h((b.getUserName||a&&a.getUserName||g).call(a,null!=(e=null!=a?a.attributes:a)?e.authorID:e,{name:"getUserName",hash:{},data:d}))+'"/>\n			<div class="msg-dtl-inr">\n				<h3 class="msg-agent">'+h((b.getUserName||a&&a.getUserName||g).call(a,null!=(e=null!=a?a.attributes:a)?e.authorID:e,{name:"getUserName",hash:{},data:d}))+'</h3>\n				<h4 class="msg-company">'+h((b.getCompanyName||a&&a.getCompanyName||g).call(a,null!=(e=null!=a?a.attributes:a)?e.authorID:e,{name:"getCompanyName",hash:{},data:d}))+'</h4>\n				<div class="msg-date">'+h((b.convertToDateTime||a&&a.convertToDateTime||g).call(a,null!=(e=null!=a?a.attributes:a)?e.date:e,{name:"convertToDateTime",hash:{},data:d}))+'</div>\n			</div>\n			<div class="msg-tri"></div>\n		</div>\n		<div class="msg-body">					\n			<div class="msg-subject">\n				<h5>'+h(i(null!=(e=null!=a?a.attributes:a)?e.subject:e,a))+"</h5>	\n				<span>Ticket #"+h(i(null!=(e=null!=a?a.attributes:a)?e.reference:e,a))+"</span>						\n			</div>\n			<div>\n				"+h(i(null!=(e=null!=a?a.attributes:a)?e.message:e,a))+'							\n			</div>						\n			<ul class="files">\n'+(null!=(e=b.each.call(a,null!=(e=null!=a?a.attributes:a)?e.files:e,{
name:"each",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+"			</ul>\n			"+h((b.downloadTicketAttachments||a&&a.downloadTicketAttachments||g).call(a,null!=(e=null!=a?a.attributes:a)?e.files:e,{name:"downloadTicketAttachments",hash:{},data:d}))+"\n"+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.messagesCollection:a)?e.length:e,{name:"if",hash:{},fn:this.program(6,d,0),inverse:this.program(8,d,0),data:d}))?e:"")+'	</li>\n	<div id="messages-wrap">\n	</div>	\n</ul>'},useData:!0}),this.JST.userview=Handlebars.template({1:function(a,b,c,d){var e;return this.escapeExpression(this.lambda(null!=(e=null!=a?a.attributes:a)?e.avatar:e,a))},3:function(a,b,c,d){return"application/assets/img/avatar.png"},5:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return g(f(null!=(e=null!=a?a.attributes:a)?e.firstName:e,a))+" "+g(f(null!=(e=null!=a?a.attributes:a)?e.lastName:e,a))},7:function(a,b,c,d){var e;return this.escapeExpression(this.lambda(null!=(e=null!=a?a.attributes:a)?e.emailAddress:e,a))},9:function(a,b,c,d){var e,f=b.helperMissing,g=this.escapeExpression;return"	<h4>"+g((b.getCompanyName||a&&a.getCompanyName||f).call(a,null!=a?a.id:a,{name:"getCompanyName",hash:{},data:d}))+" "+g((b.convertUserRole||a&&a.convertUserRole||f).call(a,null!=(e=null!=a?a.attributes:a)?e.role:e,{name:"convertUserRole",hash:{},data:d}))+"</h4>\n"},11:function(a,b,c,d){return'	<h4>Awaiting Verification</h4>\n	<a class="resend-verification">Resend</a> \n'},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return'<img class="avatar" src="'+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.attributes:a)?e.avatar:e,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.program(3,d,0),data:d}))?e:"")+'" alt="'+g(f(null!=(e=null!=a?a.attributes:a)?e.firstName:e,a))+" "+g(f(null!=(e=null!=a?a.attributes:a)?e.lastName:e,a))+'" />\n<h3>'+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.attributes:a)?e.firstName:e,{name:"if",hash:{},fn:this.program(5,d,0),inverse:this.program(7,d,0),data:d}))?e:"")+"</h3>\n"+(null!=(e=(b.ifCond||a&&a.ifCond||b.helperMissing).call(a,null!=(e=null!=a?a.attributes:a)?e.verify:e,!0,{name:"ifCond",hash:{},fn:this.program(9,d,0),inverse:this.program(11,d,0),data:d}))?e:"")+'<a class="delete-user">Delete</a>'},useData:!0});var houston={ordinalSuffix:function(a){if(11>a||a>13)switch(a%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"},convertToDate:function(a){var b=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),c=a.toString(),d=c.substring(8,10),e=c.substring(5,7)-1;return c=d+" "+b[e]},convertToDateTime:function(a){var b=new Array("January","February","March","April","May","June","July","August","September","October","November","December"),c=a.toString(),d=c.substring(8,10),e=c.substring(5,7)-1,f=c.substring(0,4),g=this.ordinalSuffix(d),h="am",i=c.substring(11,13);i>12?(i-=12,h="pm"):12==i&&(h="pm");var j=c.substring(14,16);return c=d+g+" "+b[e]+" "+f+" "+i+":"+j+h},convertToClass:function(a){var b=a.toLowerCase().split(" ").join("-");return b},convertUserRole:function(a){var b="Unknown Role";return"undefined"!=typeof a&&("ADMIN"===a?b="Administrator":"AGENT"===a?b="Support Agent":"USER"===a&&(b="User")),b},dropSelect:function(a){var a=$(a),b=a.closest(".drop-top"),c=a.closest(".dropdown").find(".drop");b.hasClass("rounded")?(c.slideToggle(200),b.toggleClass("rounded")):c.slideToggle(200,function(){b.toggleClass("rounded")})},dropDown:function(a){var b=$(a),c=b.data("class"),d=b.text(),e="<span>"+d+'</span><i class="icon-down-dir-1"></i>',f=b.closest(".dropdown");f.find(".drop-slct").removeClass("on-hold in-progress").addClass(c).html(e);var g=b.closest(".drop");g.slideToggle(200,function(){$(this).closest(".dropdown").find(".drop-top").toggleClass("rounded on-hold"),g.toggleClass("on-hold"),f.hasClass("dropswitch")?(g.find("li").each(function(){var a=$(this);a.toggleClass("slct"),a.toggleClass("n-slct")}),houston.dropDownAttribute="status"):(g.find("li").removeClass("slct"),b.addClass("slct"),houston.dropDownAttribute="agent")});var h;return f.hasClass("dropswitch")?h={param:"status",value:d}:(d=b.data("id"),h={param:"agent",value:d}),h},generateDropSwitch:function(a){return"In Progress"===a?'<div class="dropdown dropswitch"><div class="drop-inner"><div class="drop-top on-hold rounded"><div class="btn in-progress drop-slct"><span>In Progress</span><i class="icon-down-dir-1"></i></div></div><ul class="drop on-hold"><li class="slct" data-class="in-progress">In Progress</li><li class="n-slct" data-class="on-hold">On Hold</li></ul></div></div>':"On Hold"===a?'<div class="dropdown dropswitch"><div class="drop-inner"><div class="drop-top in-progress rounded"><div class="btn on-hold drop-slct"><span>On Hold</span><i class="icon-down-dir-1"></i></div></div><ul class="drop in-progress"><li class="slct" data-class="on-hold">On Hold</li><li class="n-slct" data-class="in-progress">In Progress</li></ul></div></div>':"Completed"===a?'<div class="btn completed">Completed</div>':void 0},replyToggle:function(a){a.find(".reply").slideToggle(),a.find("#form-reply textarea").focus();var b=a.closest(document).scrollTop()+310;a.closest("html, body").animate({scrollTop:b})},updateCheck:function(a){var b,c=!1;for(b=0;b<a.length;++b)a[b]==app.user.id&&(c=!0);return c},populateAgentDropdown:function(){var a,b=app.users.filter(function(a){return"USER"!==a.get("role")}),c="";for(a=0;a<b.length;++a)c+='<li data-id="'+b[a].id+'">'+dataHelper.getUserName(b[a].id)+"</li>";return c},dateArrow:function(){return 1===app.tickets.byDateOrder?'<i class="icon-up-dir"></i>':2===app.tickets.byDateOrder?'<i class="icon-down-dir-1"></i>':'<i class="icon-down-dir-1 inactive"></i>'},companyArrow:function(){return 1===app.tickets.byCompanyOrder?'<i class="icon-up-dir"></i>':2===app.tickets.byCompanyOrder?'<i class="icon-down-dir-1"></i>':'<i class="icon-down-dir-1 inactive"></i>'},forEach:function(a,b){return b.inverse&&!a.length?b.inverse(this):a.map(function(c,d){return c.$index=d,c.$first=0===d,c.$last=d===a.length-1,b.fn(c)}).join("")},subjectCharCount:function(a){var b=75,c=a.find(".new-sub"),d=c.val(),e=d.length;e>=b&&(c.val(d.substr(0,b)),e=b);var f=b-e,g=a.find(".char-count span");g.text(f),10>=f?g.addClass("count"):g.removeClass("count"),0==f?a.find(".char-count").addClass("count"):a.find(".char-count").removeClass("count")},calculateBoxHeight:function(){var a=$(window).height(),b=a-270;return b},isDisplayableImage:function(a){return-1==a.indexOf("jpeg")&&-1==a.indexOf("png")&&-1==a.indexOf("pdf")?!1:!0},validateForm:function(a){var b=!0,c=$(a).closest("form"),d=c.find(".required");return d.each(function(){var a=$(this);""==a.val()?(a.addClass("error"),b=!1):a.removeClass("error"),a.is("input[type=email]")&&(address=a.val(),houston.validateEmail(address)?a.removeClass("error"):(b=!1,a.addClass("error")))}),b},validateEmail:function(a){var b=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i;return b.test(a)?!0:!1},validateAndApproveEmail:function(a,b,c){var d=a.val();if(!this.validateEmail(d))return void a.addClass("error");a.removeClass("error");var e=$.get("/api/check/email?email="+d);e.done(function(c){b&&b(a)}),e.fail(function(b,d){c&&c(a)})},formatFileType:function(a){var b="FILE";if(a)switch(a.split("/")[1]){case"jpeg":b="JPG";break;case"png":b="PNG";break;case"gif":b="GIF";break;case"psd":b="PSD";break;case"pdf":b="PDF";break;case"plain":b="TXT"}return b},previewImageResize:function(){var a=$(window).height(),b=a-190;return b},previewImageResizeWidth:function(){var a=$(window).width(),b=a-80;return b},displayUpdates:function(a){if(0===a)var b="";else if(a>99)var b='<div class="update-alert">99</div>';else if(a>9)var b='<div class="update-alert"><span>'+a+"</span></div>";else b='<div class="update-alert">'+a+"</div>";$("#update-alert").html(b)},createModal:function(a,b,c){app.modal=new ModalView({model:new Backbone.Model(a)}),b&&(app.modal.confirmBehaviour=b),c&&(app.modal.cancelBehaviour=c),app.modalWindow.html(app.modal.$el),app.modal.render()}},handlebarsHelpers={bindHelpers:function(){for(var a in handlebarsHelpers.helpers)Handlebars.registerHelper(a,handlebarsHelpers.helpers[a])},helpers:{ifCond:function(a,b,c){return console.log(a),a===b?c.fn(this):c.inverse(this)},forEach:function(a,b){return houston.forEach(a,b)},fullHeightPage:function(){return new Handlebars.SafeString("min-height:"+houston.calculateBoxHeight()+"px;")},getUserName:function(a){return new Handlebars.SafeString(dataHelper.getUserName(a))},getUserRoleAsClass:function(a){return new Handlebars.SafeString(dataHelper.getUserRoleAsClass(a))},getCompanyName:function(a){return new Handlebars.SafeString(dataHelper.getCompanyName(a))},getUserAvatar:function(a){return new Handlebars.SafeString(dataHelper.getUserAvatar(a))},convertUserRole:function(a){return new Handlebars.SafeString(houston.convertUserRole(a))},convertToClass:function(a){return houston.convertToClass(a)},convertToDate:function(a){return houston.convertToDate(a)},isPDF:function(a,b){return new Handlebars.SafeString('<object data="/api/tickets/file/inline/'+b+'" type="application/pdf" width="100%" height="100%" frameborder="0"> alt : <a href="/api/tickets/file/'+b+'">test.pdf</a> </object>')},updateCheck:function(a){return new Handlebars.SafeString(houston.updateCheck(a))},dateArrow:function(){return new Handlebars.SafeString(houston.dateArrow())},companyArrow:function(){return new Handlebars.SafeString(houston.companyArrow())},populateAgentDropdown:function(){return new Handlebars.SafeString(houston.populateAgentDropdown())},convertToDateTime:function(a){return houston.convertToDateTime(a)},generateDropSwitch:function(a){return new Handlebars.SafeString(houston.generateDropSwitch(a))},outputMarkAsCompleted:function(a){return"USER"!==app.user.get("role")?new Handlebars.SafeString('<input id="completed" type="checkbox" name="ticket-completed" value="completed" /><label for="completed">Mark ticket as completed</label>'):void 0},showFilePreviewLink:function(a,b){return a&&houston.isDisplayableImage(a)?new Handlebars.SafeString('<a data-index="'+b+'" class="file-preview">Preview</a>'):void 0},downloadTicketAttachments:function(a){if(a.length>1){var b="";return a.forEach(function(a){b+="id[]="+a.ref+"&"}),b=b.substring(0,b.length-1),new Handlebars.SafeString('<a class="attachments-link" data-bypass="true" href="http://'+window.location.hostname+"/api/tickets/file/zip?"+b+'">Download All Attachments</a>')}},showFileUploadPreviewLink:function(a,b,c){return b&&houston.isDisplayableImage(a)?new Handlebars.SafeString('<a data-cid="'+c+'" class="file-preview">Preview</a>'):void 0},formatFileType:function(a){return a?new Handlebars.SafeString(houston.formatFileType(a)):void 0},generateFilePreviousLink:function(a){return a>0?new Handlebars.SafeString('<a class="prev" data-index="'+a+'"><i class="icon-angle-circled-left"></i></a>'):void 0},generateFileNextLink:function(a,b){return b-1>a?new Handlebars.SafeString('<a class="next" data-index="'+a+'"><i class="icon-angle-circled-right"></i></a>'):void 0},maxHeightImg:function(){return new Handlebars.SafeString(houston.previewImageResize())},maxWidthImg:function(){return new Handlebars.SafeString(houston.previewImageResizeWidth())},displayAgentDelete:function(a){return"ADMIN"===app.user.attributes.role?new Handlebars.SafeString('<a class="delete-agent" data-model="'+a+'">Delete</a>'):void 0}}},dataHelper={getUserName:function(a){var b=app.users.get(a),c="Unknown User";return"undefined"!=typeof b&&(c=b.attributes.firstName?b.attributes.firstName+" "+b.attributes.lastName:b.attributes.emailAddress),c},getCompanyName:function(a){var b=app.users.get(a),c="Unknown Company";return"undefined"!=typeof b&&(c=b.attributes.clientID?app.clients.get(b.attributes.clientID).attributes.name:app.user.attributes.companyName),c},getUserRoleAsClass:function(a){var b=app.users.get(a),c="Unknown";if("undefined"!=typeof b)var c=b.attributes.role;return c},getUserAvatar:function(a){var b=app.users.get(a),c="/application/assets/img/avatar.png";return"undefined"!=typeof b&&b.attributes.avatar&&(c=b.attributes.avatar),c}},events={pageResize:function(){$(".box-app").css("min-height",houston.calculateBoxHeight())},imgMaxHeight:function(){this.$(".preview-img").css("max-height",houston.previewImageResize())},bindEvents:function(){$(window).on("resize",events.pageResize).on("resize",events.imgMaxHeight),$(".nav-icon, .mob-menu a").click(function(){$(".outer-wrap, .mob-menu").fadeToggle(300),$(".nav-icon").toggleClass("cross")}),$("#notice .close").click(function(){$(this).parent().hide()}),$(".log-out").click(function(){houston.createModal({type:"Warning",message:"Are you sure you would like to log out?",cancel:!0},function(){window.location.href="http://"+window.location.hostname+"/logout"})}),$(document).on("click","a[href]:not([data-bypass])",function(a){var b={prop:$(this).prop("href"),attr:$(this).attr("href")},c=location.protocol+"//"+location.host+app.root;b.prop.slice(0,c.length)===c&&(a.preventDefault(),Backbone.history.navigate(b.attr,!0))})}},AgentModel=Backbone.Model.extend({url:"/api/agents",parse:function(a){return a._id&&(a.id=a._id.$id,delete a._id),a}}),ClientModel=Backbone.Model.extend({urlRoot:"/api/clients",initialize:function(){this.usersCollection=new ClientUsers},parse:function(a){return a._id&&(a.id=a._id.$id,delete a._id),a}}),ClientUserModel=Backbone.Model.extend({parse:function(a){return a._id&&(a.id=a._id.$id,delete a._id),a.clientID&&(a.clientID=a.clientID.$id),a.companyID&&(a.companyID=a.companyID.$id),a},initialize:function(){this.on("destroy",function(){app.fetchUsers()})}}),FileUploadModel=Backbone.Model.extend({url:"/api/tickets/file",initialise:function(){},parse:function(a){return a._id&&(a.id=a._id.$id,delete a._id),a},defaults:{status:"initialising"}}),MessageModel=Backbone.Model.extend({parse:function(a){return a._id&&(a.id=a._id.$id,delete a._id),a.ticketID.$id&&(a.ticketID=a.ticketID.$id),a.authorID.$id&&(a.authorID=a.authorID.$id),a}}),TicketDetailModel=Backbone.Model.extend({urlRoot:"/api/tickets",initialize:function(){this.on("sync",function(){app.tickets.fetch({reset:!0})}),this.messagesCollection=new Messages},parse:function(a){return a._id&&(a.id=a._id.$id,delete a._id),a}}),TicketModel=Backbone.Model.extend({url:"/api/tickets",initialize:function(){this.on("sync",function(a){app.tickets.fetch({reset:!0})})},parse:function(a){return a._id&&(a.id=a._id.$id,delete a._id),a.authorID.$id&&(a.authorID=a.authorID.$id),a},defaults:{status:"New",agent:!1,files:[],updated:[]}}),UserModel=Backbone.Model.extend({url:"/api/user/self",parse:function(a){return a._id&&(a.id=a._id.$id,delete a._id),a.companyID&&a.companyID.$id&&(a.companyID=a.companyID.$id),a},defaults:{firstName:"",lastName:"",avatar:""}}),Agents=Backbone.Collection.extend({model:AgentModel,initialize:function(){this.on("add change destroy",function(){app.fetchUsers()})}}),Clients=Backbone.Collection.extend({model:ClientModel,url:"/api/clients",comparator:"name",initialize:function(){this.on("add change destroy",function(){app.fetchUsers()})}}),ClientUsers=Backbone.Collection.extend({model:ClientUserModel,url:"/api/users"}),Files=Backbone.Collection.extend({model:FileUploadModel,url:"/api/tickets/file/add",initialize:function(){this.filesPreviewCollection=new Backbone.Collection,this.on("reset add change delete",function(){this.filesPreviewCollection.reset(this.createImagesCollection())})},createImagesCollectionFromArray:function(a){var b=[];a.filter(function(a){a.type&&houston.isDisplayableImage(a.type)&&b.push(a)}),this.filesPreviewCollection.reset(b)},createImagesCollection:function(){var a=[];return this.filter(function(b){b.get("type")&&houston.isDisplayableImage(b.get("type"))&&a.push(b)}),a},createFilesArray:function(){var a=[];return this.each(function(b){var c={ref:b.attributes.id,name:b.attributes.name,type:b.attributes.type,date:b.attributes.lastModifiedDate};a.push(c)}),a},deleteFile:function(a){a.isNew()?(a.attributes.request.abort(),a.destroy()):(a.url="/api/tickets/file/"+a.id,a.destroy())},emptyCollection:function(){this.each(function(a){app.files.deleteFile(a)})}}),Messages=Backbone.Collection.extend({model:MessageModel,url:"/api/tickets/reply/",comparator:"date"}),Tickets=Backbone.Collection.extend({model:TicketModel,url:"/api/tickets",initialize:function(a){this.filtered=new Backbone.Collection(a),this.filtered.comparator=function(a,b){return a.get("date")>b.get("date")?-1:b.get("date")>a.get("date")?1:0},this.on("reset add",function(){this.filtered.reset(this.allTickets()),this.countUpdated()})},allTickets:function(){return filtered=this.filter(function(a){return"Completed"!==a.get("status")}),filtered},updatedTickets:function(){var a=[];return this.filter(function(b){houston.updateCheck(b.get("updated"))||a.push(b)}),a},byAgent:function(){return filtered=this.filter(function(a){return a.get("agent")==app.user.id&&"Completed"!==a.get("status")}),filtered},byCompleted:function(){return filtered=this.filter(function(a){return"Completed"===a.get("status")}),filtered},byFilter:function(a,b){return filtered=this.filter(function(c){return c.get(a)===b}),filtered},countUpdated:function(){if(app.updateElem){var a=0;this.filter(function(b){houston.updateCheck(b.get("updated"))||a++}),houston.displayUpdates(a)}},byDateOrder:2,byDate:function(){this.byCompanyOrder=!1,1!==this.byDateOrder&&this.byDateOrder?2===this.byDateOrder&&(this.byDateOrder=1,this.filtered.comparator=function(a){return a.get("date")}):(this.byDateOrder=2,this.filtered.comparator=function(a,b){return a.get("date")>b.get("date")?-1:b.get("date")>a.get("date")?1:0}),this.filtered.sort()},byCompanyOrder:!1,byCompany:function(){this.byDateOrder=!1,1!==this.byCompanyOrder&&this.byCompanyOrder?2===this.byCompanyOrder&&(this.byCompanyOrder=1,this.filtered.comparator=function(a,b){return dataHelper.getCompanyName(a.get("authorID"))<dataHelper.getCompanyName(b.get("authorID"))?1:dataHelper.getCompanyName(b.get("authorID"))>dataHelper.getCompanyName(a.get("authorID"))?-1:0}):(this.byCompanyOrder=2,this.filtered.comparator=function(a){return dataHelper.getCompanyName(a.get("authorID"))}),this.filtered.sort()}}),Users=Backbone.Collection.extend({model:ClientUserModel,url:"/api/users",initialize:function(){this.on("sync",function(){app.agentsCollection.reset(this.agentUsers())})},usersByClient:function(a){return filtered=this.filter(function(b){return b.get("clientID")===a}),filtered},agentUsers:function(){return filtered=this.filter(function(a){return"USER"!==a.get("role")}),filtered},addUsersToClient:function(){for(var a,b=0;b<app.clients.length;b++)a=app.clients.models[b],a.usersCollection.set(app.users.usersByClient(a.id))}}),AccountView=Backbone.View.extend({template:JST.accountview,initialize:function(){this.listenTo(this.model,"sync",this.render)},onClose:function(){this.stopListening()},render:function(){return this.$el.html(this.template()),this}}),AnalyticsView=Backbone.View.extend({template:JST.analyticsview,initialize:function(){this.listenTo(this.model,"sync",this.render)},onClose:function(){this.stopListening()},render:function(){return this.$el.html(this.template()),this}}),ClientsView=Backbone.View.extend({template:JST.clientsview,initialize:function(){this.listenTo(this.collection,"sync sort",this.render),_.bindAll(this,"renderClient")},onClose:function(){this.stopListening(),app.clients.each(function(a){a.modelView.close()})},renderClient:function(a){a.modelView=new ClientView({model:a}),a.modelView.parent=this,this.$el.find("#clients-stream").append(a.modelView.$el),a.modelView.render()},render:function(){return this.$el.html(this.template()),this.collection.each(this.renderClient),this}}),ClientView=Backbone.View.extend({tagName:"li",className:"client",template:JST.clientview,initialize:function(){this.usersView=new UsersView({collection:this.model.usersCollection}),this.usersView.parent=this},onClose:function(){this.stopListening(),this.usersView.close()},render:function(){return this.$el.html(this.template(this.model)),this.usersView.render(),this.delegateEvents({"click .delete-client":"deleteClient"}),this},deleteClient:function(){var a=this.model;houston.createModal({type:"Warning",message:"Are you sure you would like to delete "+a.attributes.name+" and all of its users?",cancel:!0},function(){a.destroy({wait:!0})})}}),FileUploadView=Backbone.View.extend({template:JST.fileuploadview,initialize:function(){this.listenTo(this.collection,"reset add change remove",this.render),this.listenTo(this.collection,"add",this.markAsChanged)},onClose:function(){this.stopListening(),app.files.length&&app.files.emptyCollection()},render:function(){this.$el.html(this.template(this.collection)),this.delegateEvents({"click .attach-link":"fileDialogTrigger","dragover #drop_zone":"handleDragOver","dragleave #drop_zone":"handleDragLeave","drop #drop_zone":"handleDragFileSelect","change #filesInput":"handleFileSelect","click .file-del":"deleteFileHandler","click .file-preview":"previewFile","click .preview-close":"previewClose"})},formatFileNameForModal:function(a){var b=a.substr(a.indexOf(".")+1);return a=a.substr(0,27)+"...["+b+"]"},deleteFileHandler:function(a){var b=$(a.currentTarget),c=b.data("cid"),d=this.collection.get(c);this.collection.deleteFile(d)},addFiles:function(a){for(var b,c=0;b=a[c];c++)if(b.size>1e8){var d=b.name;d.length>30&&(d=this.formatFileNameForModal(d)),houston.createModal({type:"File Error",message:'The file "'+d+'" is over the 100MB limit.'})}else{b.model=new FileUploadModel;var e=new FileReader;e.onloadstart=_.bind(function(a){return function(){this.collection.add(a.model)}}(b),this),e.onloadend=function(a){return function(b){var c={status:"loading",target:b.target.result,name:a.name,type:a.type,lastModifiedDate:a.lastModifiedDate};a.model.set({request:a.model.save(c,{success:function(a){a.set({status:!1})},error:function(a,b,c){console.log(b),console.log(a);var d=a.attributes.name;d.length>30&&(d=this.formatFileNameForModal(d)),houston.createModal({type:"File Error",message:'The file upload "'+d+'" was not successful.'}),app.files.deleteFile(a)}})})}}(b),e.onerror=this.fileErrorHandler,e.readAsDataURL(b)}},fileErrorHandler:function(a){switch(a.target.error.code){case 1:alert("File Not Found!");break;case 4:alert("File is not readable");break;case 3:alert("File upload aborted");break;default:alert("An error occurred reading this file.")}},fileDialogTrigger:function(){this.$el.find("#filesInput").trigger("click")},handleFileSelect:function(a){this.addFiles(a.target.files)},handleDragFileSelect:function(a){a.stopPropagation(),a.preventDefault(),$(a.currentTarget).removeClass("drop-highlight"),this.addFiles(a.dataTransfer.files)},handleDragOver:function(a){a.stopPropagation(),a.preventDefault(),$(a.currentTarget).addClass("drop-highlight"),a.dataTransfer.dropEffect="copy"},handleDragLeave:function(a){a.stopPropagation(),a.preventDefault(),$(a.currentTarget).removeClass("drop-highlight")},previewFile:function(a){var b=$(a.currentTarget),c=b.data("cid"),d=this.collection.get(c);d.set({preview:!0}),app.preview=new PreviewWindow({collection:app.files.filesPreviewCollection}),app.preview.render(),app.modalWindow.append(app.preview.$el)}}),FormView=Backbone.View.extend({template:JST.formview,initialize:function(){this.fileUploadView=new FileUploadView({collection:app.files}),this.fileUploadView.parent=this,_.bindAll(this,"keyEvent"),$(document).bind("keydown",this.keyEvent)},onClose:function(){$(document).unbind("keydown",this.keyEvent),this.fileUploadView.close()},render:function(){return app.files.reset(),this.$el.html(this.template(this.model)),this.$("#file-upload-view-wrap").append(this.fileUploadView.$el),this.fileUploadView.render(),this.delegateEvents({"click .save":"saveModel","input .new-sub":"subjectCharCount","click .cancel-btn":"cancelTicket","input input":"markAsChanged","input textarea":"markAsChanged"}),this},keyEvent:function(a){var b=a.which;13==b?(a.preventDefault(),this.saveModel()):27==b&&this.cancelTicket()},subjectCharCount:function(){return houston.subjectCharCount(this.$el)},saveModel:function(){houston.validateForm(this.$el.find(".save"))&&(this.setModelData(),this.model.save(this.model.attributes,{success:_.bind(function(){app.changed=!1,this.model=new TicketModel,app.files.reset(),app.navigate("",{trigger:!0})},this)}))},setModelData:function(){this.model.set({subject:this.$el.find('input[name="new-sub"]').val(),message:this.$el.find('textarea[name="new-textarea"]').val(),authorID:app.user.attributes.id,updated:this.model.get("updated").concat(app.user.attributes.id),files:app.files.createFilesArray()})},cancelTicket:function(){this.$el.find('input[type="text"], textarea').val(""),app.files.emptyCollection()}}),MessagesView=Backbone.View.extend({tagName:"ul",template:JST.messagesview,initialize:function(){this.listenTo(this.collection,"add sync",this.render),this.fileUploadView=new FileUploadView({collection:app.files}),this.fileUploadView.parent=this},onClose:function(){this.stopListening(),this.fileUploadView.close()},render:function(){this.$el.html(this.template(this.collection)),app.files.reset(),this.parent.$("#file-upload-view-wrap").append(this.fileUploadView.$el),this.fileUploadView.render()}}),ModalView=Backbone.View.extend({className:"modal-window-inner",template:JST.modalview,render:function(){this.$el.html(this.template(this.model.attributes)),this.delegateEvents({"click .confirm":"confirm","click .btn-can":"cancel"}),app.modalWindow.show()},initialize:function(){_.bindAll(this,"keyEvent"),$(document).bind("keydown",this.keyEvent)},onClose:function(){$(document).unbind("keydown",this.keyEvent),app.modalWindow.hide(),app.modal=!1},keyEvent:function(a){var b=a.which;27==b?this.cancel():13==b&&this.confirm()},cancel:function(){this.cancelBehaviour&&this.cancelBehaviour(),this.close(),app.preview&&(app.modalWindow.html(app.preview.$el),app.preview.render())},confirm:function(){this.confirmBehaviour&&this.confirmBehaviour(),this.close(),app.preview&&app.preview.close()}}),PeopleView=Backbone.View.extend({template:JST.peopleview,initialize:function(){this.listenTo(app.agentsCollection,"add change remove",this.render),app.agentsCollection.view=this,this.clientsView=new ClientsView({collection:app.clients}),_.bindAll(this,"keyEvent"),$(document).bind("keydown",this.keyEvent)},onClose:function(){$(document).unbind("keydown",this.keyEvent),this.stopListening(),this.clientsView.close()},render:function(){return this.$el.html(this.template(this.collection)),this.$("#clients-wrap").append(this.clientsView.render().$el),this.delegateEvents({"click .btn":"setupForm","click .new-client-user":"setupForm","click .edit-client":"setupForm","click button.btn-can":"cancelForm","click .agent-button":"validateAgent","click .delete-agent":"deleteAgent","click .client-button":"addClient","click .user-button":"validateUser","click .edit-client-button":"editClient","input input":"markAsChanged"}),this},keyEvent:function(a){if(this.formActive){var b=a.which;13==b?(a.preventDefault(),this.keyFormHandler()):27==b&&this.cancelForm()}},keyFormHandler:function(){var a=this.$el.find(".confirm");a.hasClass("user-button")?this.validateUser():a.hasClass("agent-button")?this.validateAgent():a.hasClass("client-button")&&this.addClient()},formData:[["Add New Agent","To add a new agent, simply input their email address and Houston will do the rest. Simple!","Email Address","agent-button"],["Add New Client","To add a new client, simply add the client's name below.","Client Name","client-button"],["Add New %ClientName% User","To add a new user to %ClientName%, simply input their email address and Houston will do the rest. Simple!","Email Address","user-button"],["Edit %ClientName%'s name","To edit %ClientName%'s name simply enter the amended name below.","New Name","edit-client-button"]],setupForm:function(a){var b=$(a.currentTarget),c=b.attr("data-form"),d=b.attr("data-model"),e=this.$el.find("#modal-form");if(d){var f=app.clients.get(d).attributes.name,g=this.formData[c][0].replace("%ClientName%",f),h=this.formData[c][1].replace("%ClientName%",f);e.find("h3").text(g),e.find("h4").text(h),e.find("input").attr("data-model",d)}else e.find("h3").text(this.formData[c][0]),e.find("h4").text(this.formData[c][1]);e.find("input").attr("placeholder",this.formData[c][2]),e.find(".confirm").addClass(this.formData[c][3]),this.showForm()},formActive:!1,showForm:function(){this.$el.find("#modal-form").show().find("input").focus(),this.formActive=!0},cancelForm:function(){var a=this.$el.find("#modal-form");a.find(".modal-buttons").removeClass("validated-input-resize"),a.find(".confirm").removeClass("agent-button client-button user-button edit-client-button"),a.hide().find("input").removeClass("error").val(""),this.formActive=!1},validateClient:function(){var a=this.$el.find("#modal-form-input"),b=a.val(),c=!1;return b?(a.removeClass("error"),app.clients.each(function(a){b.toLowerCase()===a.attributes.name.toLowerCase()&&(c=!0)}),c?(this.validateFail(a),!1):a):(a.addClass("error"),!1)},addClient:function(){var a=this.validateClient();if(a){var b=$(a),c=b.val(),d={name:c};app.currentView.clientsView.collection.create(d,{wait:!0,success:function(){app.changed=!1}})}},editClient:function(a){var b=$(this.validateClient());if(b){var c=b.val(),d=b.attr("data-model"),e=app.clients.get(d),f={name:c};e.save(f,{success:function(){app.changed=!1,app.clients.sort()}})}},validateAgent:function(){var a=this.$el.find("#modal-form-input");houston.validateAndApproveEmail(a,this.addAgent,this.validateFail)},validateUser:function(){var a=this.$el.find("#modal-form-input");houston.validateAndApproveEmail(a,this.addUser,this.validateFail)},validateFail:function(a){var b=a.closest("div");b.addClass("validated-input-resize")},addAgent:function(a){var b={emailAddress:a.val(),verify:!1};app.currentView.collection.create(b,{wait:!0})},deleteAgent:function(a){var b,c=this.collection.get($(a.currentTarget).attr("data-model"));b=c.attributes.firstName?c.attributes.firstName+" "+c.attributes.lastName:c.attributes.emailAddress,houston.createModal({type:"Warning",message:"Are you sure you would like to delete "+b+"?",cancel:!0},function(){c.destroy({wait:!0})})},addUser:function(a){var b=a.attr("data-model"),c={emailAddress:a.val(),clientID:b};app.currentView.clientsView.collection.get(b).usersCollection.create(c,{wait:!0,success:function(){app.changed=!1,app.fetchUsers(),app.currentView.cancelForm()}})}}),PreviewWindow=Backbone.View.extend({className:"preview-window-inner",template:JST.previewwindow,initialize:function(){this.listenTo(this.collection,"reset add change remove",this.render),_.bindAll(this,"keyEvent"),$(document).bind("keydown",this.keyEvent)},onClose:function(){$(document).unbind("keydown",this.keyEvent),this.stopListening(),app.modalWindow.hide(),app.preview=!1},render:function(){this.$el.html(this.template(this.collection)),this.delegateEvents({"click .preview-close":"previewClose","click .prev":"clickPrevious","click .next":"clickNext"}),app.modalWindow.show()},keyEvent:function(a){var b=a.which;37==b?this.keyMove("previous"):39==b?this.keyMove("next"):27==b&&this.previewClose()},keyMove:function(a){var b=this.collection.findWhere({preview:!0}),c=this.collection.indexOf(b);if("previous"==a){if(0==c)return;this.previous(c)}else if("next"==a){if(c+1==this.collection.length)return;this.next(c)}},clickPrevious:function(a){var b=$(a.currentTarget),c=b.data("index");this.previous(c)},clickNext:function(a){var b=$(a.currentTarget),c=b.data("index");this.next(c)},previous:function(a){var b=a-1;this.collection.models[a].set({preview:!1}),this.collection.models[b].set({preview:!0})},next:function(a){var b=a+1;this.collection.models[a].set({preview:!1}),this.collection.models[b].set({preview:!0})},previewClose:function(){this.collection.forEach(function(a,b){a.unset("preview",{silent:!0})}),this.close()}}),ProfileView=Backbone.View.extend({template:JST.profileview,
initialize:function(){this.listenTo(this.model,"add change",this.render),_.bindAll(this,"keyEvent"),$(document).bind("keydown",this.keyEvent),this.selection.prototype.draw=function(a){a.ctx.strokeStyle="#000",a.ctx.lineWidth=2,a.ctx.strokeRect(this.x,this.y,this.w,this.h),this.w>0&&this.h>0&&a.ctx.drawImage(a.image,this.x,this.y,this.w,this.h,this.x,this.y,this.w,this.h),a.ctx.fillStyle="#fff",a.ctx.fillRect(this.x-this.iCSize[0],this.y-this.iCSize[0],2*this.iCSize[0],2*this.iCSize[0]),a.ctx.fillRect(this.x+this.w-this.iCSize[1],this.y-this.iCSize[1],2*this.iCSize[1],2*this.iCSize[1]),a.ctx.fillRect(this.x+this.w-this.iCSize[2],this.y+this.h-this.iCSize[2],2*this.iCSize[2],2*this.iCSize[2]),a.ctx.fillRect(this.x-this.iCSize[3],this.y+this.h-this.iCSize[3],2*this.iCSize[3],2*this.iCSize[3])}},onClose:function(){$(document).unbind("keydown",this.keyEvent),this.stopListening()},render:function(){return this.$el.html(this.template(this.model)),this.delegateEvents({"input input":"markAsChanged","click .update-avatar-link":"fileDialogTrigger","change #filesInput":"handleFileSelect","dragover #avatar-drop":"handleDragOver","dragleave #avatar-drop":"handleDragLeave","drop #avatar-drop":"handleDragFileSelect","click .toggle-button-outer":"toggleEmails","click .preview-close":"previewClose","mousemove #panel":"canvasMousemove","mousedown #panel":"canvasMousedown","mouseup #panel":"canvasMouseup","click .crop":"getResults","click .grayscale":"grayscaleHandler","click #form-profile-details button":"updateDetails","click #form-profile-details .cancel-btn":"cancelUpdateDetails","input input[type=email]":"validateEmail","input .current-password":"validatePassword","focus .new-password":"passwordCounterReveal","blur .new-password":"passwordCounterHide","input .new-password":"newPasswordCount","input .repeat-password":"confirmPassword","click #form-profile-password button":"updatePassword","click #form-profile-password .cancel-btn":"cancelUpdatePassword"}),this},cancelUpdatePassword:function(){var a=this.$el.find("#form-profile-password input");a.each(function(){var a=$(this);a.val(""),a.closest("div").removeClass("validated-input-resize"),a.hasClass("current-password")?a.attr("disabled",!1):a.attr("disabled",!0)})},updatePassword:function(a){var b=this.$el.find(".current-password").val(),c=this.$el.find(".new-password").val(),d=this.$el.find(".repeat-password").val();if(b&&c&&d)if(b&&c===d){var e=$.ajax({url:"/api/user/update/password",method:"POST",data:{currentPassword:b,newPassword:c},dataType:"json"});e.done(function(a){this.$el.find("#form-profile-password .response").addClass("text-animate").find("h3").text("Your password has been updated")}),e.fail(function(a,b){alert("Request failed: "+b)})}else this.cancelUpdatePassword(),this.$el.find("#form-profile-password .response").addClass("text-animate").find("h3").text("Submission failed, please try again")},confirmPassword:function(a){var b=$(a.currentTarget),c=b.val(),d=this.$el.find(".new-password").val(),e=b.closest("div");c==d?e.addClass("validated-input-resize"):e.removeClass("validated-input-resize")},passwordCounterReveal:function(a){var b=$(a.currentTarget).closest("div");b.addClass("validated-input-resize")},passwordCounterHide:function(a){var b=$(a.currentTarget),c=b.closest("div");c.find(".vrf-cir").hasClass("ok")||c.removeClass("validated-input-resize")},newPasswordCount:function(a){var b=$(a.currentTarget),c=b.val(),d=c.length,e=b.closest("div"),f=e.find(".vrf-cir"),g=8,h=this.$el.find(".repeat-password");c!==h.val()&&(h.closest("div").removeClass("validated-input-resize"),h.attr("disabled",!0)),8>d?(f.text(g-d),f.removeClass("ok"),e.find(".vrf-cir").fadeIn(),h.attr("disabled",!0)):(f.html('<i class="icon-ok-1"></i>'),f.addClass("ok"),h.attr("disabled",!1))},validatePassword:function(a){var b=$(a.currentTarget),c=b.val();if(c.length<=7)b.closest("div").removeClass("validated-input-resize");else if(c.length>7){var d=$.get("/api/check/password?password="+c);d.done(function(a){var c=b.closest("div");c.addClass("validated-input-resize"),b.attr("disabled",!0),c.closest("form").find(".new-password").attr("disabled",!1)}),d.fail(function(a,c){b.closest("div").removeClass("validated-input-resize")})}},updateDetails:function(a){var b=!1,c=$(a.currentTarget).closest("form"),d=c.find("input");d.each(function(){var a=$(this),c=a.val();if(!a.hasClass("error")&&c){var d=a.attr("name");app.user.set(d,c),b=!0}}),b&&this.model.save(this.model.attributes,{success:_.bind(function(a){this.$el.find("#form-profile-details .response").addClass("text-animate"),app.changed=!1},this)})},cancelUpdateDetails:function(a){var b=$(a.currentTarget).closest("form");b.find(".validated-input-resize").removeClass("validated-input-resize");var c=b.find("input");c.each(function(){var a=$(this);a.val(""),a.removeClass("error")})},validateEmail:function(a){var b=$(a.currentTarget);houston.validateAndApproveEmail(b,this.validateEmailSuccess,this.validateEmailFail)},validateEmailSuccess:function(a){a.closest("div").removeClass("validated-input-resize")},validateEmailFail:function(a){var b=a.closest("div");b.addClass("validated-input-resize")},keyEvent:function(a){var b=a.which;27==b&&this.previewClose()},fileDialogTrigger:function(){this.$el.find("#filesInput").trigger("click")},handleFileSelect:function(a){this.addAvatar(a.target.files[0])},handleDragFileSelect:function(a){a.stopPropagation(),a.preventDefault(),$(a.currentTarget).removeClass("drop-highlight"),this.addAvatar(a.dataTransfer.files[0])},handleDragOver:function(a){a.stopPropagation(),a.preventDefault(),$(a.currentTarget).addClass("drop-highlight"),a.dataTransfer.dropEffect="copy"},handleDragLeave:function(a){a.stopPropagation(),a.preventDefault(),$(a.currentTarget).removeClass("drop-highlight")},toggleEmails:function(a){$(a.currentTarget).toggleClass("on")},previewClose:function(){$("#canvas-wrap").html("").removeClass("active, max-height-canvas-image")},addAvatar:function(a){var b=new FileReader;b.onloadend=_.bind(function(a){return function(a){this.addImageToCanvas(a.target.result)}}(a),this),b.readAsDataURL(a)},grayscaleImage:!1,grayscaleHandler:function(a){$(a.currentTarget).toggleClass("gray"),this.grayscaleImage?this.grayscaleImage=!1:this.grayscaleImage=!0,this.drawScene()},makeGrayscale:function(a){for(var b=a.getImageData(0,0,this.canvas.width,this.canvas.height),c=b.data,d=0,e=c.length;e>d;d+=4){var f=.3*c[d]+.59*c[d+1]+.11*c[d+2];c[d]=f,c[d+1]=f,c[d+2]=f}a.putImageData(b,0,0)},canvas:null,image:null,iMouseX:null,iMouseY:1,theSelection:null,addImageToCanvas:function(a){this.image=new Image,this.image.src=a;var b=this.image.width,c=this.image.height,d=$(window).width()-40,e=$(window).height()-70;if(c>e)return void houston.createModal({type:"Error",message:"The image you are attempting to use is too large please try a smaller image."});if(b>d){var f=d,g=b-f,h=g/(b/100),i=c-c/100*h;this.image.width=f,this.image.height=i;var j,k;k=document.createElement("canvas"),j=k.getContext("2d"),k.width=f,k.height=i,j.drawImage(this.image,0,0,b,c,0,0,f,i),this.image.src=k.toDataURL()}this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),$(this.canvas).attr({width:this.image.width,height:this.image.height,id:"panel"}),$("#canvas-wrap").html('<div class="canvas-blackout-bg"></div><div class="canvas-window-inner"><div class="preview-wrap"><div class="preview-img-wrap"><i class="preview-close icon-cancel-circled"></i><div class="preview-img-box"><div class="canvas"></div><button class="crop">Crop and Save</button><button class="grayscale"><span class="g">Grayscale</span><span class="c">Colour</span></button></div></div></div></div>'),$(".canvas").html(this.canvas),$("#canvas-wrap").addClass("active"),this.theSelection=new this.selection(200,200,200,200),this.drawScene()},selection:function(a,b,c,d){this.x=a,this.y=b,this.w=c,this.h=d,this.px=a,this.py=b,this.csize=6,this.csizeh=10,this.bHow=[!1,!1,!1,!1],this.iCSize=[this.csize,this.csize,this.csize,this.csize],this.bDrag=[!1,!1,!1,!1],this.bDragAll=!1},drawScene:function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.drawImage(this.image,0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.fillStyle="rgba(0, 0, 0, 0.5)",this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.theSelection.draw(this),this.grayscaleImage&&this.makeGrayscale(this.ctx)},canvasMousemove:function(a){var b=$(this.canvas).offset();for(this.iMouseX=Math.floor(a.pageX-b.left),this.iMouseY=Math.floor(a.pageY-b.top),this.theSelection.bDragAll&&(this.theSelection.x=this.iMouseX-this.theSelection.px,this.theSelection.y=this.iMouseY-this.theSelection.py),i=0;i<4;i++)this.theSelection.bHow[i]=!1,this.theSelection.iCSize[i]=this.theSelection.csize;this.iMouseX>this.theSelection.x-this.theSelection.csizeh&&this.iMouseX<this.theSelection.x+this.theSelection.csizeh&&this.iMouseY>this.theSelection.y-this.theSelection.csizeh&&this.iMouseY<this.theSelection.y+this.theSelection.csizeh&&(this.theSelection.bHow[0]=!0,this.theSelection.iCSize[0]=this.theSelection.csizeh),this.iMouseX>this.theSelection.x+this.theSelection.w-this.theSelection.csizeh&&this.iMouseX<this.theSelection.x+this.theSelection.w+this.theSelection.csizeh&&this.iMouseY>this.theSelection.y-this.theSelection.csizeh&&this.iMouseY<this.theSelection.y+this.theSelection.csizeh&&(this.theSelection.bHow[1]=!0,this.theSelection.iCSize[1]=this.theSelection.csizeh),this.iMouseX>this.theSelection.x+this.theSelection.w-this.theSelection.csizeh&&this.iMouseX<this.theSelection.x+this.theSelection.w+this.theSelection.csizeh&&this.iMouseY>this.theSelection.y+this.theSelection.h-this.theSelection.csizeh&&this.iMouseY<this.theSelection.y+this.theSelection.h+this.theSelection.csizeh&&(this.theSelection.bHow[2]=!0,this.theSelection.iCSize[2]=this.theSelection.csizeh),this.iMouseX>this.theSelection.x-this.theSelection.csizeh&&this.iMouseX<this.theSelection.x+this.theSelection.csizeh&&this.iMouseY>this.theSelection.y+this.theSelection.h-this.theSelection.csizeh&&this.iMouseY<this.theSelection.y+this.theSelection.h+this.theSelection.csizeh&&(this.theSelection.bHow[3]=!0,this.theSelection.iCSize[3]=this.theSelection.csizeh);var c,d;if(this.theSelection.bDrag[0]){var e=this.iMouseX-this.theSelection.px,f=this.iMouseY-this.theSelection.py;c=this.theSelection.w+this.theSelection.x-e,d=this.theSelection.h+this.theSelection.y-f}if(this.theSelection.bDrag[1]){var e=this.theSelection.x,f=this.iMouseY-this.theSelection.py;c=this.iMouseX-this.theSelection.px-e,d=this.theSelection.h+this.theSelection.y-f}if(this.theSelection.bDrag[2]){var e=this.theSelection.x,f=this.theSelection.y;c=this.iMouseX-this.theSelection.px-e,d=this.iMouseY-this.theSelection.py-f}if(this.theSelection.bDrag[3]){var e=this.iMouseX-this.theSelection.px,f=this.theSelection.y;c=this.theSelection.w+this.theSelection.x-e,d=this.iMouseY-this.theSelection.py-f}c>2*this.theSelection.csizeh&&d>2*this.theSelection.csizeh&&(this.theSelection.w=c,this.theSelection.h=d,this.theSelection.x=e,this.theSelection.y=f),this.drawScene()},canvasMousedown:function(a){var b=$(this.canvas).offset();for(this.iMouseX=Math.floor(a.pageX-b.left),this.iMouseY=Math.floor(a.pageY-b.top),this.theSelection.px=this.iMouseX-this.theSelection.x,this.theSelection.py=this.iMouseY-this.theSelection.y,this.theSelection.bHow[0]&&(console.log("0"),this.theSelection.px=this.iMouseX-this.theSelection.x,this.theSelection.py=this.iMouseY-this.theSelection.y),this.theSelection.bHow[1]&&(console.log("1"),this.theSelection.px=this.iMouseX-this.theSelection.x-this.theSelection.w,this.theSelection.py=this.iMouseY-this.theSelection.y),this.theSelection.bHow[2]&&(console.log("2"),this.theSelection.px=this.iMouseX-this.theSelection.x-this.theSelection.w,this.theSelection.py=this.iMouseY-this.theSelection.y-this.theSelection.h),this.theSelection.bHow[3]&&(console.log("3"),this.theSelection.px=this.iMouseX-this.theSelection.x,this.theSelection.py=this.iMouseY-this.theSelection.y-this.theSelection.h),this.iMouseX>this.theSelection.x+this.theSelection.csizeh&&this.iMouseX<this.theSelection.x+this.theSelection.w-this.theSelection.csizeh&&this.iMouseY>this.theSelection.y+this.theSelection.csizeh&&this.iMouseY<this.theSelection.y+this.theSelection.h-this.theSelection.csizeh&&(this.theSelection.bDragAll=!0),i=0;i<4;i++)this.theSelection.bHow[i]&&(this.theSelection.bDrag[i]=!0)},canvasMouseup:function(a){for(this.theSelection.bDragAll=!1,i=0;i<4;i++)this.theSelection.bDrag[i]=!1;this.theSelection.px=0,this.theSelection.py=0},getResults:function(){var a,b;b=document.createElement("canvas"),a=b.getContext("2d"),b.width=this.theSelection.w,b.height=this.theSelection.h,a.drawImage(this.image,this.theSelection.x,this.theSelection.y,this.theSelection.w,this.theSelection.h,0,0,this.theSelection.w,this.theSelection.h),this.grayscaleImage&&this.makeGrayscale(a);var c=b.toDataURL();this.model.set("avatar",c),this.model.save(this.model.attributes),this.previewClose()}}),TicketHeaderView=Backbone.View.extend({className:"box-app-top msg-top",agentTemplate:JST.ticketheaderview,userTemplate:JST.ticketheaderviewuser,initialize:function(){this.listenTo(this.model,"sync",this.render)},onClose:function(){this.stopListening()},render:function(){return"USER"===app.user.attributes.role?this.$el.html(this.userTemplate(this.model)):this.$el.html(this.agentTemplate(this.model)),this}}),TicketsView=Backbone.View.extend({template:JST.ticketsview,initialize:function(){this.listenTo(this.collection,"reset add remove change sort sync",this.render)},onClose:function(){this.stopListening()},render:function(){return this.$el.html(this.template(this.collection)),this.delegateEvents({"click .sortByDate":"sortByDate","click .sortByCompany":"sortByCompany","click .myTickets":"byAgent","click .completedTickets":"byCompleted","click .updatedTickets":"updated","click .allTickets":"all"}),this},all:function(){this.collection.reset(app.tickets.allTickets())},updated:function(){this.collection.reset(app.tickets.updatedTickets())},byAgent:function(){this.collection.reset(app.tickets.byAgent())},byCompleted:function(){this.collection.reset(app.tickets.byCompleted())},sortByDate:function(){app.tickets.byDate()},sortByCompany:function(){app.tickets.byCompany()}}),TicketDetailView=Backbone.View.extend({template:JST.ticketview,initialize:function(){this.listenTo(this.model.messagesCollection,"sync",this.render),this.ticketHeaderView=new TicketHeaderView({model:this.model}),this.ticketHeaderView.parent=this,this.messagesView=new MessagesView({collection:this.model.messagesCollection}),this.messagesView.parent=this},onClose:function(){this.ticketHeaderView.close(),this.messagesView.close()},render:function(){return this.$el.html(this.template(this.model)),app.files.reset(),this.$(".box-app-fixed-inner").append(this.ticketHeaderView.$el),this.ticketHeaderView.render(),this.$("#messages-wrap").append(this.messagesView.$el),this.messagesView.render(),houston.updateCheck(this.model.get("updated"))||this.updateSeen(),this.delegateEvents({"click .drop-slct":"dropSelect","click .dropdown li":"dropDown","click .reply-btn":"replyToggle","click .cancel-btn":"replyToggle","click .add-message":"addMessage","click .file-preview":"filePreview","input textarea":"markAsChanged"}),this},dropSelect:function(a){houston.dropSelect(a.currentTarget)},dropDown:function(a){var b=houston.dropDown(a.currentTarget);if("status"==b.param)this.model.set({status:b.value});else{this.model.set({agent:b.value});var c=this.model.get("status");"New"==c&&this.model.set({status:"In Progress"})}this.saveModel()},replyToggle:function(){houston.replyToggle(this.$el)},updateSeen:function(){this.model.set({updated:this.model.get("updated").concat(app.user.id)}),this.model.save(this.model.attributes)},saveModel:function(){this.model.set({updated:[app.user.id]}),this.model.save(this.model.attributes)},addMessage:function(a){if(houston.validateForm(a.currentTarget)){this.$el.find('input[name="ticket-completed"]').prop("checked")&&this.model.set({status:"Completed"});var b={authorID:app.user.id,message:this.$el.find('textarea[name="new-textarea"]').val(),files:app.files.createFilesArray()};this.model.messagesCollection.create(b,{wait:!0,success:function(){app.changed=!1,console.log("success")}}),this.saveModel()}},filePreview:function(a){var b=$(a.currentTarget),c=b.data("index"),d=b.closest("ul");if(d.data("reply")){var e=d.data("reply");app.files.createImagesCollectionFromArray(this.model.messagesCollection.get(e).attributes.files)}else app.files.createImagesCollectionFromArray(this.model.attributes.files);app.files.filesPreviewCollection.models[c].set({preview:!0}),app.preview=new PreviewWindow({collection:app.files.filesPreviewCollection}),app.preview.render(),app.modalWindow.html(app.preview.$el)}}),UsersView=Backbone.View.extend({template:JST.usersview,initialize:function(){this.listenTo(this.collection,"add change remove",this.render),_.bindAll(this,"renderUser")},onClose:function(){this.stopListening(),this.collection.each(function(a){a.modelView.close()})},renderUser:function(a){a.modelView=new UserView({model:a}),a.modelView.parent=this,this.parent.$el.find(".client-user-stream").append(a.modelView.$el),a.modelView.render()},render:function(){return this.parent.$el.find(".client-user-stream").html(""),0==this.collection.length?this.parent.$el.find(".client-user-stream").html(this.template):this.collection.each(this.renderUser),this}}),UserView=Backbone.View.extend({tagName:"li",className:"person",template:JST.userview,onClose:function(){this.stopListening()},render:function(){return this.$el.html(this.template(this.model)),this.delegateEvents({"click .delete-user":"deleteUser"}),this},deleteUser:function(){var a,b=this.model,c=b.attributes;a=c.firstName?c.firstName+" "+c.lastName:c.emailAddress,houston.createModal({type:"Warning",message:"Are you sure you would like to delete "+a+"?",cancel:!0},function(){b.destroy({wait:!0})})}});Backbone.View.prototype.markAsChanged=function(){app.changed=Backbone.history.fragment},Backbone.View.prototype.close=function(){this.remove(),this.unbind(),this.onClose&&this.onClose()};var AppRouter=Backbone.Router.extend({root:"/",routes:{"":"indexFrontController","tickets/new":"ticketFormFrontController","tickets/:ticket":"ticketDetailsFrontController",people:"peopleOverviewFrontController",profile:"profileFrontController",account:"accountMainFrontController","*notFound":"indexFrontController"},initialize:function(){$.ajaxSetup({timeout:0}),jQuery.event.props.push("dataTransfer"),window.File&&window.FileReader&&window.FileList&&window.Blob||console.warn("The File API is not fully supported by this browser"),this.user=new UserModel,this.users=new Users,this.tickets=new Tickets,this.ticketDetailModel=new TicketDetailModel,this.agentsCollection=new Agents,this.clients=new Clients,this.files=new Files,this.fetchData()},fetchData:function(a){$.when(this.user.fetch({reset:!0}),this.users.fetch({reset:!0}),this.tickets.fetch({reset:!0})).done(function(){app.fetchClients(a)})},fetchUsers:function(a){$.when(this.users.fetch({reset:!0})).done(function(){app.fetchClients(a)})},fetchClients:function(a){$.when(app.clients.fetch({reset:!0})).done(function(){app.users.addUsersToClient(),app.currentView?a&&a():app.initializeSuccess()})},initializeSuccess:function(){app.setUpSocket(),app.startHistory()},fetchError:function(a,b,c){console.log(a)},setUpSocket:function(){var a=io("http://"+window.location.hostname+":3000/"+app.user.attributes.companyID);a.on("notify",function(b){$("#notice span").html(b),$("#notice").fadeIn(1e3,function(){$(this).delay(5e3).fadeOut(1e3)}),a.emit("response","success"),app.fetchData()})},startHistory:function(){handlebarsHelpers.bindHelpers(),events.bindEvents(),this.modalWindow=$("#modal-window"),this.appElement=$("#app"),this.updateElem=$("update-alert"),this.tickets.countUpdated(),$(function(){Backbone.history.start({pushState:!0,root:app.root})})},currentView:!1,showView:function(a){this.currentView&&this.currentView.close(),this.currentView=a,this.appElement.html(this.currentView.render().el)},indexFrontController:function(){var a=new TicketsView({collection:this.tickets.filtered});this.showView(a)},ticketDetailsFrontController:function(a){this.ticketDetailModel.messagesCollection.url="/api/tickets/reply/"+a,this.ticketDetailModel.set(this.tickets.get(a).attributes),$.when(this.ticketDetailModel.messagesCollection.fetch({reset:!0})).done(function(){var a=new TicketDetailView({model:app.ticketDetailModel});app.showView(a)})},ticketFormFrontController:function(){var a=new FormView({model:new TicketModel});this.showView(a)},peopleOverviewFrontController:function(){var a=new PeopleView({collection:app.agentsCollection});app.showView(a)},createAndShowPeopleView:function(){var a=new PeopleView({collection:app.agentsCollection});app.showView(a)},profileFrontController:function(){var a=new ProfileView({model:this.user});this.showView(a)},accountMainFrontController:function(){var a=new AccountView({model:this.user});this.showView(a)},modal:!1,preview:!1,changed:!1,executeArguments:!1,execute:function(a,b,c){this.changed||this.executeArguments?!this.changed&&this.executeArguments?(this.executeArguments.callback.apply(this,this.executeArguments.args),this.executeArguments=!1):(this.executeArguments={callback:a,args:b,name:c},houston.createModal({type:"Warning",message:"Any unsaved changes will be lost, would you like to continue?",cancel:!0},function(){app.changed=!1,app.execute()},function(){app.navigate(app.changed,{trigger:!1})})):(a&&a.apply(this,b),app.preview&&(app.preview.close(),app.preview=!1))}});!function a(){setTimeout(function(){$.get("/api/session/check",function(b){var c=JSON.parse(b);"SESSION_CHECK"===c.code&&"error"===c.status?window.location.href="/logout":a()})},5e3)}();var app=new AppRouter;
//# sourceMappingURL=ticketapp.min.js.map